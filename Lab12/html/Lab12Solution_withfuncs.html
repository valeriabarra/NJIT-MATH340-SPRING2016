
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Lab 11 Solution</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-04-13"><meta name="DC.source" content="Lab12Solution.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Lab 11 Solution</h1><!--introduction--><p>Lab Instructor: Valeria Barra</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Problem 1: Runge-Kutta 4</a></li></ul><h2>Called Functions</h2><ul><li><a href="#RungeKutta2">RungeKutta2 </a></li><li><a href="#RungeKutta4">RungeKutta4 </a></li></ul></div><p>DUE Tuesday 04-19-2016 ;</p><h2>Problem 1: Runge-Kutta 4<a name="2"></a></h2><p>Implement your own RK-2 and RK-4 methods to solve the same IVP seen last week. Reproduce the table, showing the grid points <img src="Lab12Solution_eq14450145758366837506.png" alt="$t_i$">, approximated solution <img src="Lab12Solution_eq11174449752623653570.png" alt="$w_i$">, the actual solution <img src="Lab12Solution_eq08366435799313302571.png" alt="$y_i$"> and the error <img src="Lab12Solution_eq16537821098686504121.png" alt="$e_i$">, all at the same grid points <img src="Lab12Solution_eq12666374333687270468.png" alt="$t_i = 0, 0.2, 0.4, 0.6, 0.8, 1.0$">. To compute the error at each grid point <img src="Lab12Solution_eq11275726639961136444.png" alt="$e_i= |y(t_i) - w_i|$"> use the value for the actual solution given <img src="Lab12Solution_eq04453727003757653977.png" alt="$y(t) = 3 e ^{{t^2}/2} - t^2 - 2$">.</p><p><b>Solution:</b></p><pre class="codeinput">clear <span class="string">all</span>; close <span class="string">all</span>;
<span class="comment">% function handle of the RHS function for the problem</span>
f=@(t,y)(t.*y + t.^3);
<span class="comment">% the actual solution</span>
y=@(t)( 3*exp((t.^2)./2) - t.^2 -2);
h=[0.2 0.1 0.05];

<span class="comment">% the IC given</span>
w0=1;

Colors = [<span class="string">'c'</span> <span class="string">'g'</span> <span class="string">'b'</span>]; <span class="comment">% different colors used for the different curves</span>
Styles = [<span class="string">':'</span>, <span class="string">'--'</span>, <span class="string">'.-'</span>]; <span class="comment">% different line styles used for the different curves</span>

<span class="comment">% the main cycle of the call of the function and display starts here</span>
<span class="keyword">for</span> j=1:length(h)
    t{j}=(0:h(j):1); <span class="comment">% domain</span>
    <span class="comment">% the call of the methods</span>
    wRK2{j}=RungeKutta2(f, t{j}, w0,h(j));
    wRK4{j}=RungeKutta4(f, t{j}, w0,h(j));
    <span class="comment">% plots of all the approximations here</span>
    figure(1) <span class="comment">% opens a new figure and labels it as figure 1</span>
    hold <span class="string">on</span>
    plot(t{j},wRK2{j},<span class="string">'linestyle'</span>,Styles(j),<span class="string">'color'</span>,Colors(j),<span class="string">'linewidth'</span>,2);

    figure(2) <span class="comment">% opens a new figure and labels it as figure 2</span>
    plot(t{j},wRK4{j},<span class="string">'linestyle'</span>,Styles(j),<span class="string">'color'</span>,Colors(j),<span class="string">'linewidth'</span>,2);
    hold <span class="string">on</span>
<span class="keyword">end</span>


<span class="comment">% plot of actual solution here</span>
figure(1)
plot(t{j},y(t{j}),<span class="string">'--r'</span>,<span class="string">'linewidth'</span>,2) <span class="comment">% plots the real solution only once</span>
<span class="comment">% attributes of the figure 1 here</span>
title(<span class="string">'Problem 1: RK-2'</span>)
xlabel(<span class="string">'t'</span>)
ylabel(<span class="string">'w'</span>)
box <span class="string">on</span>
legend({<span class="string">'$w_{h=0.2}$'</span>,<span class="string">'$w_{h=0.1}$'</span>,<span class="string">'$w_{h=0.05}$'</span>,<span class="string">'y'</span>},<span class="string">'interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'fontsize'</span>,16,<span class="string">'location'</span>,<span class="string">'northwest'</span>);
figure(2)
plot(t{j},y(t{j}),<span class="string">'--r'</span>,<span class="string">'linewidth'</span>,2) <span class="comment">% plots the real solution only once</span>
<span class="comment">% attributes of the figure 2 here</span>
title(<span class="string">'Problem 1: RK-4'</span>)
xlabel(<span class="string">'t'</span>)
ylabel(<span class="string">'w'</span>)
box <span class="string">on</span>
legend({<span class="string">'$w_{h=0.2}$'</span>,<span class="string">'$w_{h=0.1}$'</span>,<span class="string">'$w_{h=0.05}$'</span>,<span class="string">'y'</span>},<span class="string">'interpreter'</span>,<span class="string">'latex'</span>,<span class="string">'fontsize'</span>,16,<span class="string">'location'</span>,<span class="string">'northwest'</span>);

<span class="comment">% now we only read those values that we want to display</span>
<span class="keyword">for</span> i=1:length(h)
        TPrint{i}=t{i}(1:h(1)/h(i):end); <span class="comment">% select only the values we want to print in the table</span>
        WRK2Print{i}=wRK2{i}(1:h(1)/h(i):end); <span class="comment">% select only the values we want to print in the table</span>
        WRK4Print{i}=wRK4{i}(1:h(1)/h(i):end); <span class="comment">% select only the values we want to print in the table</span>
    <span class="keyword">if</span> i==length(h)
        ErrorRK2=abs(y(TPrint{i}) - WRK2Print{i}); <span class="comment">% error calculated point-wise only with the third execution</span>
        ErrorRK4=abs(y(TPrint{i}) - WRK4Print{i}); <span class="comment">% error calculated point-wise only with the third execution</span>
    <span class="keyword">end</span>

<span class="keyword">end</span>

<span class="comment">% table for RK-2</span>
fprintf(<span class="string">'\nExecution of Problem 1, RK-2 \n'</span>)
fprintf(<span class="string">'__________________________________________________________________________________________\n\n'</span>)
fprintf(<span class="string">'t        w_{h=0.2}(t_i)  w_{h=0.1}(t_i)  w_{h=0.05}(t_i)     y_i       Error w_{h=0.05} \n'</span>)
fprintf(<span class="string">'__________________________________________________________________________________________\n'</span>)

<span class="comment">% print the table</span>
tableRK2=[(TPrint{1,3})' (WRK2Print{1,1})' (WRK2Print{1,2})' (WRK2Print{1,3})' (y(TPrint{1,3}))' (ErrorRK2)'];
fprintf(<span class="string">'%2.1f        %6.4f          %6.4f          %6.4f          %6.4f          %6.4e \n'</span>,tableRK2')
<span class="comment">%end of table line</span>
fprintf(<span class="string">'__________________________________________________________________________________________\n'</span>)

<span class="comment">% table for RK-4</span>
fprintf(<span class="string">'\nExecution of Problem 1, RK-4 \n'</span>)
fprintf(<span class="string">'__________________________________________________________________________________________\n\n'</span>)
fprintf(<span class="string">'t        w_{h=0.2}(t_i)  w_{h=0.1}(t_i)  w_{h=0.05}(t_i)     y_i       Error w_{h=0.05} \n'</span>)
fprintf(<span class="string">'__________________________________________________________________________________________\n'</span>)

tableRK4=[(TPrint{1,3})' (WRK4Print{1,1})' (WRK4Print{1,2})' (WRK4Print{1,3})' (y(TPrint{1,3}))' (ErrorRK4)'];
fprintf(<span class="string">'%2.1f        %6.4f          %6.4f          %6.4f          %6.4f          %6.4e \n'</span>,tableRK4')
<span class="comment">%end of table line</span>
fprintf(<span class="string">'__________________________________________________________________________________________\n'</span>)


pRK2= log2((WRK2Print{1,2}(end) - WRK2Print{1,1}(end))/(WRK2Print{1,3}(end) - WRK2Print{1,2}(end)));
fprintf(<span class="string">'The order of converegnce of RK-2 at the point t_i = 1 is p = %4.2f. That is roughly 2.\n'</span>,pRK2)

pRK4= log2((WRK4Print{1,2}(end) - WRK4Print{1,1}(end))/(WRK4Print{1,3}(end) - WRK4Print{1,2}(end)));
fprintf(<span class="string">'The order of converegnce of RK-4 at the point t_i = 1 is p = %4.2f. That is roughly 4.\n'</span>,pRK4)
</pre><pre class="codeoutput">
Execution of Problem 1, RK-2 
__________________________________________________________________________________________

t        w_{h=0.2}(t_i)  w_{h=0.1}(t_i)  w_{h=0.05}(t_i)     y_i       Error w_{h=0.05} 
__________________________________________________________________________________________
0.0        1.0000          1.0000          1.0000          1.0000          0.0000e+00 
0.2        1.0208          1.0207          1.0206          1.0206          2.1478e-05 
0.4        1.0909          1.0902          1.0899          1.0899          8.7939e-05 
0.6        1.2340          1.2323          1.2318          1.2317          1.8449e-04 
0.8        1.4949          1.4924          1.4917          1.4914          2.7374e-04 
1.0        1.9494          1.9471          1.9464          1.9462          2.6690e-04 
__________________________________________________________________________________________

Execution of Problem 1, RK-4 
__________________________________________________________________________________________

t        w_{h=0.2}(t_i)  w_{h=0.1}(t_i)  w_{h=0.05}(t_i)     y_i       Error w_{h=0.05} 
__________________________________________________________________________________________
0.0        1.0000          1.0000          1.0000          1.0000          0.0000e+00 
0.2        1.0206          1.0206          1.0206          1.0206          2.5901e-09 
0.4        1.0899          1.0899          1.0899          1.0899          1.0193e-08 
0.6        1.2316          1.2317          1.2317          1.2317          2.2996e-08 
0.8        1.4914          1.4914          1.4914          1.4914          4.4549e-08 
1.0        1.9461          1.9462          1.9462          1.9462          9.0354e-08 
__________________________________________________________________________________________
The order of converegnce of RK-2 at the point t_i = 1 is p = 1.67. That is roughly 2.
The order of converegnce of RK-4 at the point t_i = 1 is p = 4.02. That is roughly 4.
</pre><img vspace="5" hspace="5" src="Lab12Solution_01.png" alt=""> <img vspace="5" hspace="5" src="Lab12Solution_02.png" alt=""> <p><b>Comments on results:</b> From the values for each row in the two tables, we can see that RK-2 scheme is of order two locally. In fact, as h is halved for each execution, the corresponding error for each grid point is roughly divided by four. Whereas RK-4 scheme is of order four locally. In fact, as h is halved for each execution, the corresponding error for each grid point is roughly divided by sixteen. Whereas Euler forward method was only of order one. This can also be seen from the p value. The figures look almost identical, except for the one for RK-4 that starts, even with the the coarsest approximation, closer to the actual solution.</p><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Lab 11 Solution
% Lab Instructor: Valeria Barra
%%
% DUE Tuesday 04-19-2016 ;
%% Problem 1: Runge-Kutta 4
% Implement your own RK-2 and RK-4 methods to solve the same IVP seen last week. Reproduce the table, showing the grid points $t_i$, approximated solution $w_i$, the actual solution $y_i$ and the error $e_i$, all at the same grid points $t_i = 0, 0.2, 0.4, 0.6, 0.8, 1.0$. To compute the error at each grid point $e_i= |y(t_i) - w_i|$ use the value for the actual solution given $y(t) = 3 e ^{{t^2}/2} - t^2 - 2$.

%%
% *Solution:*
clear all; close all;
% function handle of the RHS function for the problem
f=@(t,y)(t.*y + t.^3);
% the actual solution
y=@(t)( 3*exp((t.^2)./2) - t.^2 -2);
h=[0.2 0.1 0.05];

% the IC given
w0=1;

Colors = ['c' 'g' 'b']; % different colors used for the different curves
Styles = [':', 'REPLACE_WITH_DASH_DASH', '.-']; % different line styles used for the different curves

% the main cycle of the call of the function and display starts here
for j=1:length(h)    
    t{j}=(0:h(j):1); % domain 
    % the call of the methods
    wRK2{j}=RungeKutta2(f, t{j}, w0,h(j));
    wRK4{j}=RungeKutta4(f, t{j}, w0,h(j));
    % plots of all the approximations here
    figure(1) % opens a new figure and labels it as figure 1
    hold on
    plot(t{j},wRK2{j},'linestyle',Styles(j),'color',Colors(j),'linewidth',2);
    
    figure(2) % opens a new figure and labels it as figure 2
    plot(t{j},wRK4{j},'linestyle',Styles(j),'color',Colors(j),'linewidth',2);
    hold on
end


% plot of actual solution here
figure(1)
plot(t{j},y(t{j}),'REPLACE_WITH_DASH_DASHr','linewidth',2) % plots the real solution only once
% attributes of the figure 1 here
title('Problem 1: RK-2')
xlabel('t')
ylabel('w')
box on
legend({'$w_{h=0.2}$','$w_{h=0.1}$','$w_{h=0.05}$','y'},'interpreter','latex','fontsize',16,'location','northwest');
figure(2)
plot(t{j},y(t{j}),'REPLACE_WITH_DASH_DASHr','linewidth',2) % plots the real solution only once
% attributes of the figure 2 here
title('Problem 1: RK-4')
xlabel('t')
ylabel('w')
box on
legend({'$w_{h=0.2}$','$w_{h=0.1}$','$w_{h=0.05}$','y'},'interpreter','latex','fontsize',16,'location','northwest');

% now we only read those values that we want to display
for i=1:length(h)
        TPrint{i}=t{i}(1:h(1)/h(i):end); % select only the values we want to print in the table
        WRK2Print{i}=wRK2{i}(1:h(1)/h(i):end); % select only the values we want to print in the table
        WRK4Print{i}=wRK4{i}(1:h(1)/h(i):end); % select only the values we want to print in the table
    if i==length(h)
        ErrorRK2=abs(y(TPrint{i}) - WRK2Print{i}); % error calculated point-wise only with the third execution 
        ErrorRK4=abs(y(TPrint{i}) - WRK4Print{i}); % error calculated point-wise only with the third execution 
    end

end

% table for RK-2
fprintf('\nExecution of Problem 1, RK-2 \n')
fprintf('__________________________________________________________________________________________\n\n')
fprintf('t        w_{h=0.2}(t_i)  w_{h=0.1}(t_i)  w_{h=0.05}(t_i)     y_i       Error w_{h=0.05} \n')
fprintf('__________________________________________________________________________________________\n')

% print the table
tableRK2=[(TPrint{1,3})' (WRK2Print{1,1})' (WRK2Print{1,2})' (WRK2Print{1,3})' (y(TPrint{1,3}))' (ErrorRK2)'];
fprintf('%2.1f        %6.4f          %6.4f          %6.4f          %6.4f          %6.4e \n',tableRK2')
%end of table line
fprintf('__________________________________________________________________________________________\n')

% table for RK-4
fprintf('\nExecution of Problem 1, RK-4 \n')
fprintf('__________________________________________________________________________________________\n\n')
fprintf('t        w_{h=0.2}(t_i)  w_{h=0.1}(t_i)  w_{h=0.05}(t_i)     y_i       Error w_{h=0.05} \n')
fprintf('__________________________________________________________________________________________\n')

tableRK4=[(TPrint{1,3})' (WRK4Print{1,1})' (WRK4Print{1,2})' (WRK4Print{1,3})' (y(TPrint{1,3}))' (ErrorRK4)'];
fprintf('%2.1f        %6.4f          %6.4f          %6.4f          %6.4f          %6.4e \n',tableRK4')
%end of table line
fprintf('__________________________________________________________________________________________\n')


pRK2= log2((WRK2Print{1,2}(end) - WRK2Print{1,1}(end))/(WRK2Print{1,3}(end) - WRK2Print{1,2}(end)));
fprintf('The order of converegnce of RK-2 at the point t_i = 1 is p = %4.2f. That is roughly 2.\n',pRK2)

pRK4= log2((WRK4Print{1,2}(end) - WRK4Print{1,1}(end))/(WRK4Print{1,3}(end) - WRK4Print{1,2}(end)));
fprintf('The order of converegnce of RK-4 at the point t_i = 1 is p = %4.2f. That is roughly 4.\n',pRK4)


%%
% *Comments on results:*
% From the values for each row in the two tables, we can see that RK-2 scheme is of order two locally. In fact, as
% h is halved for each execution, the corresponding error for each grid point is roughly
% divided by four. Whereas RK-4 scheme is of order four locally. In fact, as
% h is halved for each execution, the corresponding error for each grid point is roughly
% divided by sixteen. Whereas Euler forward method was only of order one.
% This can also be seen from the p value. The figures look almost
% identical, except for the one for RK-4 that starts, even with the the coarsest
% approximation, closer to the actual solution.

##### SOURCE END #####
--></body></html>
<a name="RungeKutta2"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>RungeKutta2</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-04-13"><meta name="DC.source" content="RungeKutta2.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [w]=RungeKutta2(f, t, y0,h)
<span class="comment">% this function implements Runge-Kutta scheme of order two for an IVP. The IC is given as</span>
<span class="comment">% argument together with the domain vector t and the function of the RHS of</span>
<span class="comment">% the ODE f and the mesh spacing h.</span>

w(1) = y0;
n=length(t);
<span class="keyword">for</span> i = 1:n-1 <span class="comment">% subtract one because the value for t0=0 is already assigned by the IC, so we don't need to solve for that</span>
    v1=f(t(i) , w(i))';
    v2=f(t(i) + h , w(i) + h.*v1)';
    w(i+1) = w(i) + (h/2).*(v1+v2);
<span class="keyword">end</span>


<span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
\n
--></body></html>
<a name="RungeKutta4"></a>

<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>RungeKutta4</title><meta name="generator" content="MATLAB 8.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-04-13"><meta name="DC.source" content="RungeKutta4.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> [w]=RungeKutta4(f, t, y0,h)
<span class="comment">% this function implements Runge-Kutta scheme of order four for an IVP. The IC is given as</span>
<span class="comment">% argument together with the domain vector t and the function of the RHS of</span>
<span class="comment">% the ODE f and the mesh spacing h.</span>

w(1) = y0;
n=length(t);
<span class="keyword">for</span> i = 1:n-1 <span class="comment">% subtract one because the value for t0=0 is already assigned by the IC, so we don't need to solve for that</span>
    v1=f(t(i) , w(i))';
    v2=f(t(i) + h/2 , w(i) + (h/2).*v1)';
    v3=f(t(i) + h/2 , w(i) + (h/2).*v2)';
    v4=f(t(i) + h , w(i) + h.*v3)';
    w(i+1) = w(i) + (h/6).*(v1 + 2.*v2 + 2.*v3 + v4);
<span class="keyword">end</span>


<span class="keyword">end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015a</a><br></p></div><!--
\n
--></body></html>
